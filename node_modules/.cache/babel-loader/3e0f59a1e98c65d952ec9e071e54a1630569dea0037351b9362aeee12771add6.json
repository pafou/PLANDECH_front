{"ast":null,"code":"import React,{useState,useEffect}from'react';import{BrowserRouter as Router,Route,Routes,Link}from'react-router-dom';import'./App.css';import Modif from'./components/Modif';import{API_BASE_URL}from'./apiConfig';// Déclare le composant Home\nimport UserSelect from'./components/UserSelect';import Admin from'./components/Admin';import{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";function Home(){const token=localStorage.getItem('jwtToken');const decodedToken=token?JSON.parse(atob(token.split('.')[1])):null;const userId=decodedToken?decodedToken.userId:'';useEffect(()=>{if(userId){document.title=\"Plan de charge - User: \".concat(userId);}else{document.title='Plan de charge';}},[userId]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Home Page - User: \",userId]}),/*#__PURE__*/_jsx(UserSelect,{})]});}function App(){const[user,setUser]=useState(null);const[isAdmin,setIsAdmin]=useState(false);useEffect(()=>{const token=localStorage.getItem('jwtToken');if(token){const decodedToken=JSON.parse(atob(token.split('.')[1]));setUser(decodedToken.userId);document.title=\"Plan de charge - User: \".concat(decodedToken.userId);console.log(\"debug:: test\");// Check if the user is an admin\nfetch(\"\".concat(API_BASE_URL,\"/api/is-admin\"),{headers:{Authorization:\"Bearer \".concat(token)}}).then(response=>response.json()).then(data=>{setIsAdmin(data.isAdmin);}).catch(error=>{console.error('Error checking admin status:',error);});}else{setUser(null);document.title='Plan de charge';}},[]);return/*#__PURE__*/_jsx(Router,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"App-header\",children:[/*#__PURE__*/_jsxs(\"h1\",{children:[\"Plan de charge - User: \",user]}),/*#__PURE__*/_jsxs(\"nav\",{className:\"banner\",children:[/*#__PURE__*/_jsx(Link,{to:\"/\",className:\"banner-button\",children:\"Home\"}),isAdmin&&/*#__PURE__*/_jsx(Link,{to:\"/admin\",className:\"banner-button\",children:\"Admin\"}),/*#__PURE__*/_jsx(Link,{to:\"/modif\",className:\"banner-button\",children:\"Modif\"})]})]}),/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(Home,{})}),/*#__PURE__*/_jsx(Route,{path:\"/admin\",element:/*#__PURE__*/_jsx(Admin,{})}),/*#__PURE__*/_jsx(Route,{path:\"/modif\",element:/*#__PURE__*/_jsx(Modif,{})}),/*#__PURE__*/_jsx(Route,{path:\"*\",element:/*#__PURE__*/_jsx(Home,{})})]})]})});}// Exporte App par défaut\nexport default App;","map":{"version":3,"names":["React","useState","useEffect","BrowserRouter","Router","Route","Routes","Link","Modif","API_BASE_URL","UserSelect","Admin","jsxs","_jsxs","jsx","_jsx","Home","token","localStorage","getItem","decodedToken","JSON","parse","atob","split","userId","document","title","concat","children","App","user","setUser","isAdmin","setIsAdmin","console","log","fetch","headers","Authorization","then","response","json","data","catch","error","className","to","path","element"],"sources":["/Users/pascal/workspace/plan_de_charge/front/src/App.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { BrowserRouter as Router, Route, Routes, Link } from 'react-router-dom';\nimport './App.css';\nimport Modif from './components/Modif';\nimport { API_BASE_URL } from './apiConfig';\n\n// Déclare le composant Home\nimport UserSelect from './components/UserSelect';\nimport Admin from './components/Admin';\n\nfunction Home() {\n  const token = localStorage.getItem('jwtToken');\n  const decodedToken = token ? JSON.parse(atob(token.split('.')[1])) : null;\n  const userId = decodedToken ? decodedToken.userId : '';\n\n  useEffect(() => {\n    if (userId) {\n      document.title = `Plan de charge - User: ${userId}`;\n    } else {\n      document.title = 'Plan de charge';\n    }\n  }, [userId]);\n\n  return (\n    <div>\n      <h2>Home Page - User: {userId}</h2>\n      <UserSelect />\n    </div>\n  );\n}\n\nfunction App() {\n  const [user, setUser] = useState(null);\n  const [isAdmin, setIsAdmin] = useState(false);\n\n  useEffect(() => {\n    const token = localStorage.getItem('jwtToken');\n    if (token) {\n      const decodedToken = JSON.parse(atob(token.split('.')[1]));\n      setUser(decodedToken.userId);\n      document.title = `Plan de charge - User: ${decodedToken.userId}`;\n                  console.log(\"debug:: test\");\n\n      // Check if the user is an admin\n      fetch(`${API_BASE_URL}/api/is-admin`, {\n        headers: {\n          Authorization: `Bearer ${token}`,\n        },\n      })\n        .then(response => response.json())\n        .then(data => {\n          setIsAdmin(data.isAdmin);\n        })\n        .catch(error => {\n          console.error('Error checking admin status:', error);\n        });\n    } else {\n      setUser(null);\n      document.title = 'Plan de charge';\n    }\n  }, []);\n\n  return (\n    <Router>\n      <div className=\"App\">\n        <header className=\"App-header\">\n          <h1>Plan de charge - User: {user}</h1>\n          <nav className=\"banner\">\n            <Link to=\"/\" className=\"banner-button\">Home</Link>\n            {isAdmin && <Link to=\"/admin\" className=\"banner-button\">Admin</Link>}\n            <Link to=\"/modif\" className=\"banner-button\">Modif</Link>\n          </nav>\n        </header>\n        <Routes>\n        <Route path=\"/\" element={<Home />} />\n        <Route path=\"/admin\" element={<Admin />} />\n        <Route path=\"/modif\" element={<Modif />} />\n        <Route path=\"*\" element={<Home />} />\n        </Routes>\n      </div>\n    </Router>\n  );\n}\n\n// Exporte App par défaut\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}