{"ast":null,"code":"import React from'react';import{API_BASE_URL}from'../apiConfig';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AdminManageAdmin=_ref=>{let{userId,admins,setAdmins,users,setUsers,selectedUserId,setSelectedUserId}=_ref;const handleDelete=(id,name,firstname)=>{const isConfirmed=window.confirm(\"Are you sure you want to delete \".concat(firstname,\" \").concat(name,\"?\"));if(isConfirmed){const token=localStorage.getItem('jwtToken');if(token){fetch(\"\".concat(API_BASE_URL,\"/api/admins/\").concat(id),{method:'DELETE',headers:{Authorization:\"Bearer \".concat(token)}}).then(response=>{if(response.ok){setAdmins(admins.filter(admin=>admin.id_pers!==id));// Fetch the updated list of users\nfetch(\"\".concat(API_BASE_URL,\"/api/persons\"),{headers:{Authorization:\"Bearer \".concat(token)}}).then(response=>response.json()).then(userData=>{setUsers(userData);}).catch(error=>{console.error('Error fetching users:',error);});}else{// No alert for error\n}}).catch(error=>{console.error('Error deleting admin:',error);// No alert for error\n});}}};const handleAddAdmin=()=>{if(selectedUserId!==null){const token=localStorage.getItem('jwtToken');if(token){fetch(\"\".concat(API_BASE_URL,\"/api/admins\"),{method:'POST',headers:{'Content-Type':'application/json',Authorization:\"Bearer \".concat(token)},body:JSON.stringify({id_pers:selectedUserId})}).then(response=>{if(response.ok){// Fetch the updated list of admins\nfetch(\"\".concat(API_BASE_URL,\"/api/admins\"),{headers:{Authorization:\"Bearer \".concat(token)}}).then(response=>response.json()).then(adminData=>{setAdmins(adminData);// Fetch the updated list of users\nfetch(\"\".concat(API_BASE_URL,\"/api/persons\"),{headers:{Authorization:\"Bearer \".concat(token)}}).then(response=>response.json()).then(userData=>{setUsers(userData);setSelectedUserId(null);}).catch(error=>{console.error('Error fetching users:',error);});}).catch(error=>{console.error('Error fetching admins:',error);});}else{// No alert for error\n}}).catch(error=>{console.error('Error adding user as admin:',error);// No alert for error\n});}}};return/*#__PURE__*/_jsxs(\"div\",{className:\"admin-section\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Admin\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"admin-content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"admin-list\",children:/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Firstname\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:admins.sort((a,b)=>a.name.localeCompare(b.name)).map(admin=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:admin.id_pers}),/*#__PURE__*/_jsx(\"td\",{children:admin.name}),/*#__PURE__*/_jsx(\"td\",{children:admin.firstname}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{className:\"common-add-button\",onClick:()=>handleDelete(admin.id_pers,admin.name,admin.firstname),children:\"Remove\"})})]},admin.id_pers))})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"admin-add\",children:[/*#__PURE__*/_jsxs(\"select\",{value:selectedUserId!==null?selectedUserId:'',onChange:e=>setSelectedUserId(Number(e.target.value)),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select a user\"}),[...users].filter(user=>!admins.some(admin=>admin.id_pers===user.id_pers)).sort((a,b)=>a.name.localeCompare(b.name)).map(user=>/*#__PURE__*/_jsxs(\"option\",{value:user.id_pers,children:[user.name,\" \",user.firstname,\" (ID: \",user.id_pers,\")\"]},user.id_pers))]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleAddAdmin,disabled:selectedUserId===null,children:\"Add as Admin\"})]})]})]});};export default AdminManageAdmin;","map":{"version":3,"names":["React","API_BASE_URL","jsx","_jsx","jsxs","_jsxs","AdminManageAdmin","_ref","userId","admins","setAdmins","users","setUsers","selectedUserId","setSelectedUserId","handleDelete","id","name","firstname","isConfirmed","window","confirm","concat","token","localStorage","getItem","fetch","method","headers","Authorization","then","response","ok","filter","admin","id_pers","json","userData","catch","error","console","handleAddAdmin","body","JSON","stringify","adminData","className","children","sort","a","b","localeCompare","map","onClick","value","onChange","e","Number","target","user","some","disabled"],"sources":["/Users/pascal/workspace/plan_de_charge/front/src/components/Admin_manage_admin.tsx"],"sourcesContent":["import React from 'react';\nimport { API_BASE_URL } from '../apiConfig';\n\ninterface Admin {\n  id_pers: number;\n  name: string;\n  firstname: string;\n}\n\ninterface User {\n  id_pers: number;\n  name: string;\n  firstname: string;\n}\n\ninterface AdminManageAdminProps {\n  userId: string;\n  admins: Admin[];\n  setAdmins: React.Dispatch<React.SetStateAction<Admin[]>>;\n  users: User[];\n  setUsers: React.Dispatch<React.SetStateAction<User[]>>;\n  selectedUserId: number | null;\n  setSelectedUserId: React.Dispatch<React.SetStateAction<number | null>>;\n}\n\nconst AdminManageAdmin: React.FC<AdminManageAdminProps> = ({\n  userId,\n  admins,\n  setAdmins,\n  users,\n  setUsers,\n  selectedUserId,\n  setSelectedUserId\n}) => {\n\n  const handleDelete = (id: number, name: string, firstname: string) => {\n    const isConfirmed = window.confirm(`Are you sure you want to delete ${firstname} ${name}?`);\n    if (isConfirmed) {\n      const token = localStorage.getItem('jwtToken');\n      if (token) {\n        fetch(`${API_BASE_URL}/api/admins/${id}`, {\n          method: 'DELETE',\n          headers: {\n            Authorization: `Bearer ${token}`,\n          },\n        })\n          .then(response => {\n            if (response.ok) {\n              setAdmins(admins.filter((admin: Admin) => admin.id_pers !== id));\n              // Fetch the updated list of users\n              fetch(`${API_BASE_URL}/api/persons`, {\n                headers: {\n                  Authorization: `Bearer ${token}`,\n                },\n              })\n                .then(response => response.json())\n                .then(userData => {\n                  setUsers(userData);\n                })\n                .catch(error => {\n                  console.error('Error fetching users:', error);\n                });\n            } else {\n              // No alert for error\n            }\n          })\n          .catch(error => {\n            console.error('Error deleting admin:', error);\n            // No alert for error\n          });\n      }\n    }\n  };\n\n  const handleAddAdmin = () => {\n    if (selectedUserId !== null) {\n      const token = localStorage.getItem('jwtToken');\n      if (token) {\n        fetch(`${API_BASE_URL}/api/admins`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n            Authorization: `Bearer ${token}`,\n          },\n          body: JSON.stringify({ id_pers: selectedUserId }),\n        })\n          .then(response => {\n            if (response.ok) {\n              // Fetch the updated list of admins\n              fetch(`${API_BASE_URL}/api/admins`, {\n                headers: {\n                  Authorization: `Bearer ${token}`,\n                },\n              })\n                .then(response => response.json())\n                .then(adminData => {\n                  setAdmins(adminData);\n                  // Fetch the updated list of users\n                  fetch(`${API_BASE_URL}/api/persons`, {\n                    headers: {\n                      Authorization: `Bearer ${token}`,\n                    },\n                  })\n                    .then(response => response.json())\n                    .then(userData => {\n                      setUsers(userData);\n                      setSelectedUserId(null);\n                    })\n                    .catch(error => {\n                      console.error('Error fetching users:', error);\n                    });\n                })\n                .catch(error => {\n                  console.error('Error fetching admins:', error);\n                });\n            } else {\n              // No alert for error\n            }\n          })\n          .catch(error => {\n            console.error('Error adding user as admin:', error);\n            // No alert for error\n          });\n      }\n    }\n  };\n\n  return (\n    <div className=\"admin-section\">\n      <h2>Admin</h2>\n      <div className=\"admin-content\">\n        <div className=\"admin-list\">\n          <table>\n            <thead>\n              <tr>\n                <th>ID</th>\n                <th>Name</th>\n                <th>Firstname</th>\n                <th>Actions</th>\n              </tr>\n            </thead>\n            <tbody>\n              {admins\n                .sort((a, b) => a.name.localeCompare(b.name))\n                .map(admin => (\n                  <tr key={admin.id_pers}>\n                    <td>{admin.id_pers}</td>\n                    <td>{admin.name}</td>\n                    <td>{admin.firstname}</td>\n                    <td>\n                      <button className=\"common-add-button\" onClick={() => handleDelete(admin.id_pers, admin.name, admin.firstname)}>Remove</button>\n                    </td>\n                  </tr>\n                ))}\n            </tbody>\n          </table>\n        </div>\n        <div className=\"admin-add\">\n          {/* Select pour choisir un utilisateur */}\n          <select\n            value={selectedUserId !== null ? selectedUserId : ''}\n            onChange={(e) => setSelectedUserId(Number(e.target.value))}\n          >\n            <option value=\"\">Select a user</option>\n            {[...users]\n              .filter(user => !admins.some(admin => admin.id_pers === user.id_pers))\n              .sort((a, b) => a.name.localeCompare(b.name))\n              .map(user => (\n                <option key={user.id_pers} value={user.id_pers}>\n                  {user.name} {user.firstname} (ID: {user.id_pers})\n                </option>\n              ))}\n          </select>\n          <button onClick={handleAddAdmin} disabled={selectedUserId === null}>\n            Add as Admin\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default AdminManageAdmin;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}